{% extends 'garderie/base.html' %}

{% block title %}Liste des parents{% endblock %}

{% block scripts %}
<script type="text/javascript">

	var data_tab = $('#parent_tab').DataTable({
			    		"ordering": true,
			    		paging: false,
			    		"order": [[ 0, "asc" ]]
		    		});

</script>
{% endblock %}

{% block body %}
<div class="container pt-3">
	{% if user.is_authenticated %}
	<table id="parent_tab" class="display table-bordered">
		<thead>
			<th>Parent</th>
			<th>Enfants à charge</th>
			<th>Option</th>
		</thead>
		{% for parent in parent_list %}
		<tr>
			<td><a href="{% url 'parent_profile' parent.uid_id %}">{{ parent.uid.first_name }} {{ parent.uid.last_name }}</a></td>
				<td>
				{% for child in parent.child_set.all %} 
					{% if forloop.counter > 1 %}
					<br>
					{% endif %}
					<a href="{% url 'child_profile' child.id %}">{{ child.first_name }}</a>
				{% endfor %}
				</td>
			<td> 
				{% comment %} 
					TODO : Méthode grossière pour POST vers /delete/, mais 
					on doit pouvoir faire plus élégant
				{% endcomment %}
				<form method="POST" action="{% url 'parent_delete' parent.uid_id  %}">
   				{% csrf_token %}<input class="btn btn-danger btn-sm" type="submit" value="SUPPRIMER">
				</form>
			</td>
		</tr>
		{% endfor %}
	</table>
	{% else %}
		<p>Connectez-vous pour voir la liste des enfants</p>
	{% endif %}
</div>
{% endblock %}
