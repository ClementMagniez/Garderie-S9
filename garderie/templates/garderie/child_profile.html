{% extends 'garderie/base.html' %}
{% block title %}Profil de {{ child.first_name}} {{child.last_name}}{% endblock %}

{% block body %} 
<div class="d-flex justify-content-center pt-3">
 <div class="bg-light p-4 border border-secondary rounded">

<h1>{{ child.fullname}}</h1>
<p>Responsable : <a href="{% url 'parent_profile' child.parent.uid_id %}">  {{child.parent.fullname}}</a> </p>

<div class="pt-1">
	<h2>Informations personnelles</h2>
	<form action="{% url 'child_update' child.id  %}" method="post">
		{% csrf_token %}
		<table>
		{{ personal_data_form.as_table }}
		</table>

		<input type="submit" value="Valider" class="btn btn-primary">
	</form>
</div>
	
	
<div class="pt-3">
<h4>Heures de présence prévues :</h4>
<div class="border rounded">
<table class="table table-striped">
	<thead>
		<th> </th>
		<th> Heure d'arrivée </th>
		<th> Heure de départ </th>
	</thead>
{% for schedule in child.schedule_set.all %}
	{% if user.is_authenticated and user.id == child.parent.uid_id or user.is_superuser %}
		{% if schedule.expected %}
			<tr>
				<form method="POST" action="{% url 'schedule_delete' child.id schedule.id  %}?next={{request.path}}">
					{% csrf_token %}
					<td>
						<input type="submit" value="x" class="btn btn-danger btn-sm">
					</td>
					<td> {{schedule.arrival}} </td>
					<td> {{schedule.departure}} </td>
				</form>
			</tr>
		{% endif %}
	{% endif %}
{% endfor %}
</table>
</div>
</div>

<div class="pt-3">
<h4>Heures de présence récentes :</h4>
<div class="border rounded">
<table class="table table-striped">
	<thead>
		<th> </th>
		<th> Heure d'arrivé </th>
		<th> Heure de départ </th>
	</thead>
{% for schedule in child.schedule_set.recent_schedules %}
	{% if user.is_authenticated and user.id == child.parent.uid_id or user.is_superuser %}
		{% if not schedule.expected %}
			<tr>
				<form method="POST" action="{% url 'schedule_delete' child.id schedule.id  %}?next={{request.path}}">
					{% csrf_token %}
					<td>
						<input type="submit" value="x" class="btn btn-danger btn-sm">
					</td>
					<td> {{schedule.arrival}} </td>
					<td> {{schedule.departure}} </td>
				</form>
			</tr>
		{% endif %}
	{% endif %}
{% endfor %}
</table>
</div>
</div>



<div class="pt-3">

{% if user.is_authenticated and user.id == child.parent.uid_id or user.is_superuser %}
	<h3>Inscrire {{child.first_name}} à une nouvelle plage horaire</h3>
	{% include 'garderie/forms/embedded_form.html' with action=action form=schedule_form %}
{% endif %}

</div>

</div>
</div>

{% endblock %}
